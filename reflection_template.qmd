---
title: "STAT 331 Portfolio"
author: "Jonathan Flores Martinez"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: true
code-tools: true
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an B .

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1

#Lab 3 Question 2
evaluations <- read_csv(file = here::here("Week3", "Lab3", "teacher_evals.csv"))
```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2

#Lab 2 Question 1
#Revised, previously did not have here::here components
# Revision Comments For this course, you are expected to use the here()
# function from the here package to load in your data.
# If you're not sure how this works, I'd encourage you to look over this coursework page:
surveys <- read_csv(file = here::here("Week 2", "Lab 2", "surveys.csv"))


```

-   `xlsx`

```{r}
#| label: wd-1-xlsx

# nothing right now

```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1

#Lab 3 Question 5
#Select cols
teacher_evals_clean <- evaluations |> 
  select(course_id,
         teacher_id,
         question_no,
         no_participants,
         resp_share,
         SET_score_avg,
         percent_failed_cur,
         academic_degree,
         seniority,
         gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)
         ))


```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2
# Challenge 4 Open ended analysis

home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")


ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center = center_care,
                          family = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`) |> 
  
  arrange(desc(center)) |> 
    rename(`Mean Cost: Center Care` = center,
           `Mean Cost: Family Care` = family)

```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3

```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1

# Lab 3 Question 5
# Filtering rows, in this case with an inequality
teacher_evals_clean <- evaluations |> 
  select(course_id, teacher_id, question_no, no_participants, resp_share,
         SET_score_avg, percent_failed_cur, academic_degree,
         seniority, gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)
         ))

```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-2

# Lab 4 Question 6
ca_childcare |> 
  select(region, study_year, mhi_2018) |>
  filter(study_year %in% c(2008, 2018)) |> 
  group_by(region, study_year) |> 
  summarise(median_household_income = median(mhi_2018), .groups = "drop") |> 
  pivot_wider(names_from = study_year,
              values_from = median_household_income) |> 
  arrange(desc(`2018`)) |> 
  rename(`California Regions` = region,
         `Median Income in 2008` = `2008`,
         `Median Income in 2018` = `2018`)

```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character

# Lab 5, Murder mystery

get_fit_now_member |> 
  left_join(get_fit_now_check_in, by = join_by(id == membership_id)) |> 
  left_join(interview, by = join_by(person_id)) |> 
  mutate(check_in_date = ymd(check_in_date)) |> 
  filter(year(check_in_date) == 2018,
         month(check_in_date) == 01,
         day(check_in_date) == 09,
         str_detect(id, pattern = "^48Z"),
         membership_status == "gold") |> 
  select(id, name, membership_status, check_in_date, transcript)

```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string

#Lab 5, Murder mystery
# made sure that the pattern started with Annabel to account for Annabels
# with different last names

person |> 
  filter(str_detect(name, pattern = "^Annabel") &
           address_street_name == "Franklin Ave"|
           address_street_name == "Northwestern Dr" &
           address_number == max(address_number)) |> 
  left_join(interview, by = join_by(id == person_id)) |> 
  select(name, address_number, address_street_name, transcript)


```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date
# Lab 5 Murder Mystery
# revised to create a date column, it makes it easier to filter for dates

get_fit_now_member |> 
  left_join(get_fit_now_check_in, by = join_by(id == membership_id)) |> 
  left_join(interview, by = join_by(person_id)) |> 
  mutate(check_in_date = ymd(check_in_date)) |> 
  filter(year(check_in_date) == 2018,
         month(check_in_date) == 01,
         day(check_in_date) == 09,
         str_detect(id, pattern = "^48Z"),
         membership_status == "gold") |> 
  select(id, name, membership_status, check_in_date, transcript)

```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1

#Lab 3 Question 5
# mutating teacher id from the numeric format into the character format
# because it fits the context better

teacher_evals_clean <- evaluations |> 
  select(course_id, teacher_id, question_no, no_participants, resp_share,
         SET_score_avg, percent_failed_cur, academic_degree,
         seniority, gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)


```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2

```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1

# Challenge 4 
home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")


ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center = center_care,
                          family = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`) |> 
  
  arrange(desc(center)) |> 
    rename(`Mean Cost: Center Care` = center,
           `Mean Cost: Family Care` = family)

```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2

# Lab 4 Question 7
# originally the facets were in alphbetical order.
# I wanted a specific order so I created factors to reorder the levels of the facets.
ca_childcare |> 
  select(region, county_name, study_year,
         Infant = mc_infant,
         Toddler = mc_toddler,
         Preschool = mc_preschool) |> 
  pivot_longer(cols = c(Infant, Toddler, Preschool),
               names_to = "age_group",
               values_to = "median_cc_price") |>
  mutate(region = fct_reorder2(
         .f = region, .x = study_year, .y = median_cc_price),
         age_group = fct(age_group,
                         levels = c("Infant", "Toddler", "Preschool"))) |> 

  ggplot(mapping = aes(
    x = study_year, y = median_cc_price,
    color = region )) +
  geom_point(size = .8) +
  geom_smooth(method = loess, alpha = 0.2, linewidth = .6) +
  facet_wrap(~ age_group) +
  
  scale_x_continuous(breaks = seq(2008, 2018, 2)) +
  labs(title = "Weekly Median Price for Center-Based Childcare ($)",
       color = "California Region",
       x = "Study Year", y = "") +
  theme_bw() +
  theme(panel.spacing = unit(.5, "cm"), aspect.ratio = 1,
        axis.text.x = element_text(size = 7)
         )


```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string

# Challenge 4
ca_childcare <- ca_childcare |> 
  mutate(county_name = str_remove_all(county_name, " County"),
         county_name = as_factor(county_name),
         study_year = as.integer(study_year),
    `California Region` = fct_collapse(.f = county_name,
                          `Superior` = superior_counties,
                          `North Coast` = north_coast_counties,
                          `San Francisco` = san_fran_counties,
                          `North San Joaquin` = n_san_joaquin_counties,
                          `Central Coast` = central_coast_counties,
                          `Sounth San Joaquin` = s_san_joaquin_counties,
                          `Inland Empire` = inland_counties,
                          `Los Angeles` = la_county,
                          `Orange` = orange_county,
                          `San Diego-Imperial` = san_diego_imperial_counties
                          ), .before = state_name)
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date

# Lab 5
get_fit_now_member |> 
  left_join(get_fit_now_check_in, by = join_by(id == membership_id)) |> 
  left_join(interview, by = join_by(person_id)) |> 
  mutate(check_in_date = ymd(check_in_date)) |> 
  filter(year(check_in_date) == 2018,
         month(check_in_date) == 01,
         day(check_in_date) == 09,
         str_detect(id, pattern = "^48Z"),
         membership_status == "gold") |> 
  select(id, name, membership_status, check_in_date, transcript)

```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1

#Lab 4 Question 3
ca_childcare <- ca_childcare |> 
  left_join(y = tax_rev,
            by = join_by(county_name == entity_name, study_year == year))


```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right

# Challenge 5
# revised to make a right join
# good idea as this gives the resulting data set only entries
# that exist in the interview data base which is what we care about here
person |> 
  right_join(interview, by = join_by(id == person_id)) |> 
  left_join(get_fit_now_member, by = join_by(id == person_id)) |> 
  left_join(drivers_license, by = join_by(license_id == id)) |> 
  filter(membership_status == "gold",
         str_detect(plate_number,pattern = "H42W")) |> 
  select(name.x, gender, membership_status, plate_number, transcript)

```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2

#Lab 5, Murder mystery
person |> 
  filter(str_detect(name, pattern = "^Annabel") &
           address_street_name == "Franklin Ave"|
           address_street_name == "Northwestern Dr" &
           address_number == max(address_number)) |> 
  left_join(interview, by = join_by(id == person_id)) |> 
  select(name, address_number, address_street_name, transcript)


```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1

# Lab 5 Murder Mystery
#Revised to include an inner join.
# The inner join was used to make sure that all the rows in result
# existed in both data sets, this way the resulting data set had no nulls

#| label: following other lead
get_fit_now_member |> 
  inner_join(get_fit_now_check_in, by = join_by(id == membership_id)) |> 
  left_join(interview, by = join_by(person_id)) |> 
  filter(check_in_date == 20180109,
         str_detect(id, pattern = "^48Z"),
         membership_status == "gold") |> 
  mutate(check_in_date = ymd(check_in_date)) |> 
  select(id, name, membership_status, check_in_date, transcript)

```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2

#lab 5 Murder Mystery
#revised to include an inner join
# In this case the inner joins helps because the resulting data frame only
#has people who exist in the previously joined data frames
# and in the facebook event check in.

person |> 
  left_join(interview, by = join_by(id == person_id)) |> 
  left_join(drivers_license, by = join_by(license_id == id)) |> 
  inner_join(facebook_event_checkin, by = join_by(id == person_id)) |> 
  filter(car_make == "Tesla", car_model == "Model S",
         gender == "female", event_name == "SQL Symphony Concert") |> 
  mutate(date = ymd(date)) |> 
  select(name, gender, height, age, hair_color, car_make,
         car_model, event_name, date, transcript)

```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi

```

-   `anti_join()`

```{r}
#| label: wd-6-anti

```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long
# Challenge 4

home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")


ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center = center_care,
                          family = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`,
              names_prefix = "mean_cost_") |> 
  
  arrange(desc(mean_cost_center))
```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide

#Challenge 4 Open ended analysis
home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")

ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center = center_care,
                          family = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`,
              names_prefix = "mean_cost_") |> 
  
  arrange(desc(mean_cost_center))
```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Example 1: Lab 2
-   Example 2: Lab 3
-   Example 3: Lab 4
-   Example 4: Challenge 4
-   Example 5 : Lab 5

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1

# Challenge 2
ggplot(data = surveys,
    mapping = aes(x = weight, y = species)) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(color = "steel blue", alpha = 0.08) +
  labs(title = "Distribution of Weight by Species Boxplot",
       subtitle = "Horizontal Orientation",
       x = "Weight (g)",
       y = "Species Name") +
  
  theme_bw() +
  theme(panel.border = element_rect(color = "black", linewidth = 1),
        plot.title = element_text(face = "bold"),
        plot.subtitle = element_text(color = "steelblue"),
        axis.ticks.y = element_line(color = "white"),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())

```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2

# Lab 3 Question 5
# Revise my new line creation strategy here. I took peer feedback
# "The only feedback I have (which is a bit nitpicky)
# is that you put newlines on commas somewhat inconsistently". 
# I made it so 2 col names per row was consistent, I think that's clear
# and uncluttered
teacher_evals_clean <- evaluations |> 
  select(course_id, teacher_id,
         question_no, no_participants,
         resp_share, SET_score_avg,
         percent_failed_cur, academic_degree,
         seniority, gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)
         ))
```

-   Example of function formatting

```{r}
#| label: r-2-3

# Challenge 2
# labs and theme functions hav multiple arguments
ggplot(data = surveys,
    mapping = aes(x = weight, y = species)) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(color = "steel blue", alpha = 0.08) +
  labs(title = "Distribution of Weight by Species Boxplot",
       subtitle = "Horizontal Orientation",
       x = "Weight (g)",
       y = "Species Name") +
  
  theme_bw() +
  theme(panel.border = element_rect(color = "black", linewidth = 1),
        plot.title = element_text(face = "bold"),
        plot.subtitle = element_text(color = "steelblue"),
        axis.ticks.y = element_line(color = "white"),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())
```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example

# Lab 4 Problem 5
# Revised to include names_prefix() this way it is resistant to change
ca_childcare |> 
  select(region, study_year, mhi_2018) |>
  filter(study_year %in% c(2008, 2018)) |> 
  group_by(region, study_year) |> 
  summarise(median_household_income = median(mhi_2018), .groups = "drop") |> 
  pivot_wider(names_from = study_year,
              values_from = median_household_income,
              names_prefix = "Median Income in ") |> 
  arrange(desc(`Median Income in 2018`)) |> 
  rename(`California Regions` = region)

```

-   Example (function stops)

```{r}
#| label: r-3-function-stops

# Challenge 4
# Revised to include names_prefix() this way it's resitant to change
home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")


ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center = center_care,
                          family = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`,
              names_prefix = "mean_cost_") |> 
  
  arrange(desc(mean_cost_center))

```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num

# Lab 4 Question 8
ca_childcare |> 
  ggplot(mapping = aes(y = mc_infant, x = mhi_2018)) +
  geom_point() +
  geom_smooth(method = lm) +
  scale_y_continuous(labels = scales::dollar) +
  labs(y = "Median Weekly Price for Childcare ($) - Infant",
       x = "Median Household Income 2018 ($)") 
```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-2-num-cat

# Lab 3 Question 7
#| layout-ncol: 2
#| layout-align: center
#| fig-cap: 
#|   - "Figure 1: Distribution of Sex"
#|   - "Figure 2: Distribution of Seniority"
#|   - "Figure 3: Distribution of Degree Held"

individuals <- teacher_evals_clean |>
  group_by(teacher_id, sex, academic_degree, seniority) |> 
  summarise(n = n(), .groups = "drop")

individuals |> 
  group_by(sex) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = sex, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Sex", y = "Count")

individuals |> 
  group_by(seniority) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = seniority, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Seniority in Years", y = "Count")

individuals |> 
  group_by(academic_degree) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = academic_degree, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Academic Degree Held", y = "Count")

individuals |> 
  filter(academic_degree == "prof") |> 
  group_by(seniority) |> 
  summarise(n = n()) 

```

-   At least two categorical variables

```{r}
#| label: dvs-2-cat

# Challenge 4
# Year and Types of childcare
ca_cc_table |> 
  group_by(`California Region`, study_year) |> 
  summarise(`Center Based Infant` = median(mc_infant),
            `Family Based Infant` = median(mfcc_infant),
            `Center Based Toddler` = median(mc_toddler),
            `Family Based Toddler` = median(mfcc_toddler),
            `Center Based Preschool` = median(mc_preschool),
            `Family Based Preschool` = median(mfcc_preschool),
            .groups = "drop"  ) |> 
    pivot_longer(cols = - c(`California Region`, study_year), 
               names_to = "costs") |> 
  ggplot(
    mapping = aes(x = study_year, y = value, color = costs)
    ) +
    geom_jitter(alpha = 0.8 ) + 
    facet_wrap(~ `California Region`) +
  labs(x = "Year", y = "",
      color = "Types of Childcare",
      title = "Childcare Costs by Region from 2008 - 2018",
      subtitle = "Median Cost of Childcare ($)") +
  scale_y_continuous(labels = scales::label_currency(prefix = "$")) +
  
  theme_bw() +
  theme(panel.background = element_rect(fill = "gray96"))

```

-   Dates (time series plot)

```{r}
#| label: dvs-2-date

# Challenge 4
ca_cc_table |> 
  group_by(`California Region`, study_year) |> 
  summarise(`Center Based Infant` = median(mc_infant),
            `Family Based Infant` = median(mfcc_infant),
            `Center Based Toddler` = median(mc_toddler),
            `Family Based Toddler` = median(mfcc_toddler),
            `Center Based Preschool` = median(mc_preschool),
            `Family Based Preschool` = median(mfcc_preschool),
            .groups = "drop"  ) |> 
    pivot_longer(cols = - c(`California Region`, study_year), 
               names_to = "costs") |> 
  ggplot(
    mapping = aes(x = study_year, y = value, color = costs)
    ) +
    geom_jitter(alpha = 0.8 ) + 
    facet_wrap(~ `California Region`) +
  labs(x = "Year", y = "",
      color = "Types of Childcare",
      title = "Childcare Costs by Region from 2008 - 2018",
      subtitle = "Median Cost of Childcare ($)") +
  scale_y_continuous(labels = scales::label_currency(prefix = "$")) +
  
  theme_bw() +
  theme(panel.background = element_rect(fill = "gray96"))
  

```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1

# Challenge 2 
ggplot(data = surveys,
    mapping = aes(x = weight, y = species)) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(color = "steel blue", alpha = 0.08) +
  labs(title = "Distribution of Weight by Species Boxplot",
       subtitle = "Horizontal Orientation",
       x = "Weight (g)", y = "Species Name") +
  theme_bw() +
  theme(panel.border = element_rect(color = "black", linewidth = 1),
        plot.title = element_text(face = "bold"),
        plot.subtitle = element_text(color = "steelblue"),
        axis.ticks.y = element_line(color = "white"),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())

```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2

```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3

# Challenge 4
ca_cc_table |> 
  group_by(`California Region`, study_year) |> 
  summarise(`Center Based Infant` = median(mc_infant),
            `Family Based Infant` = median(mfcc_infant),
            `Center Based Toddler` = median(mc_toddler),
            `Family Based Toddler` = median(mfcc_toddler),
            `Center Based Preschool` = median(mc_preschool),
            `Family Based Preschool` = median(mfcc_preschool),
            .groups = "drop"  ) |> 
  
    pivot_longer(cols = - c(`California Region`, study_year), 
               names_to = "costs") |> 
  
  ggplot(
    mapping = aes(x = study_year, y = value, color = costs)
    ) +
    geom_jitter(alpha = 0.8 ) + 
    facet_wrap(~ `California Region`) +
  labs(x = "Year", y = "",
      color = "Types of Childcare",
      title = "Childcare Costs by Region from 2008 - 2018",
      subtitle = "Median Cost of Childcare ($)") +
  scale_y_continuous(labels = scales::label_currency(prefix = "$")) +
  
  theme_bw() +
  theme(panel.background = element_rect(fill = "gray96"))

```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4

# Challenge 2 
ggplot(data = surveys,
    mapping = aes(x = weight, y = species)) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(color = "steel blue", alpha = 0.08) +
  labs(title = "Distribution of Weight by Species Boxplot",
       subtitle = "Horizontal Orientation",
       x = "Weight (g)", y = "Species Name") +
  theme_bw() +
  theme(panel.border = element_rect(color = "black", linewidth = 1),
        plot.title = element_text(face = "bold"),
        plot.subtitle = element_text(color = "steelblue"),
        axis.ticks.y = element_line(color = "white"),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())

```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5

# Lab 4 Question 7
ca_childcare |> 
  select(region, county_name, study_year,
         Infant = mc_infant,
         Toddler = mc_toddler,
         Preschool = mc_preschool) |> 
  pivot_longer(cols = c(Infant, Toddler, Preschool),
               names_to = "age_group",
               values_to = "median_cc_price") |>
  mutate(region = fct_reorder2(
         .f = region, .x = study_year, .y = median_cc_price),
         age_group = fct(age_group,
                         levels = c("Infant", "Toddler", "Preschool"))) |> 

  ggplot(mapping = aes(
    x = study_year, y = median_cc_price,
    color = region )) +
  geom_point(size = .8) +
  geom_smooth(method = loess, alpha = 0.2, linewidth = .6) +
  facet_wrap(~ age_group) +
  
  scale_x_continuous(breaks = seq(2008, 2018, 2)) +
  labs(title = "Weekly Median Price for Center-Based Childcare ($)",
       color = "California Region",
       x = "Study Year", y = "") +
  theme_bw() +
  theme(panel.spacing = unit(.5, "cm"), aspect.ratio = 1,
        axis.text.x = element_text(size = 7)
         )

```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1

```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2

```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2

# Lab 3 Question 7
#| layout-ncol: 2
#| layout-align: center
#| fig-cap: 
#|   - "Figure 1: Distribution of Sex"
#|   - "Figure 2: Distribution of Seniority"
#|   - "Figure 3: Distribution of Degree Held"

individuals <- teacher_evals_clean |>
  group_by(teacher_id, sex, academic_degree, seniority) |> 
  summarise(n = n(), .groups = "drop")

individuals |> 
  group_by(sex) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = sex, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Sex", y = "Count")

individuals |> 
  group_by(seniority) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = seniority, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Seniority in Years", y = "Count")

individuals |> 
  group_by(academic_degree) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = academic_degree, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Academic Degree Held", y = "Count")

individuals |> 
  filter(academic_degree == "prof") |> 
  group_by(seniority) |> 
  summarise(n = n())  

```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3

```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize

# Challenge 4 Open Ended Analysis
ca_cc_table |> 
  group_by(`California Region`, study_year) |> 
  summarise(`Center Based Infant` = median(mc_infant),
            `Family Based Infant` = median(mfcc_infant),
            `Center Based Toddler` = median(mc_toddler),
            `Family Based Toddler` = median(mfcc_toddler),
            `Center Based Preschool` = median(mc_preschool),
            `Family Based Preschool` = median(mfcc_preschool),
            .groups = "drop"  ) |> 
  
    pivot_longer(cols = - c(`California Region`, study_year), 
               names_to = "costs") |> 
  
  ggplot(
    mapping = aes(x = study_year, y = value, color = costs)
    ) +
    geom_jitter(alpha = 0.8 ) + 
    facet_wrap(~ `California Region`) +
  labs(x = "Year", y = "",
      color = "Types of Childcare",
      title = "Childcare Costs by Region from 2008 - 2018",
      subtitle = "Median Cost of Childcare ($)") +
  scale_y_continuous(labels = scales::label_currency(prefix = "$")) +
  
  theme_bw() +
  theme(panel.background = element_rect(fill = "gray96"))

```

-   Example using `across()`

```{r}
#| label: dvs-4-across

# Lab 3 Question 5
teacher_evals_clean <- evaluations |> 
  select(course_id,
         teacher_id,
         question_no,
         no_participants,
         resp_share,
         SET_score_avg,
         percent_failed_cur,
         academic_degree,
         seniority,
         gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)
         ))

```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1

# Lab 3 Question 7
# Grouped by multiple variable to explore demographics
#| layout-ncol: 2
#| layout-align: center
#| fig-cap: 
#|   - "Figure 1: Distribution of Sex"
#|   - "Figure 2: Distribution of Seniority"
#|   - "Figure 3: Distribution of Degree Held"

individuals <- teacher_evals_clean |>
  group_by(teacher_id, sex, academic_degree, seniority) |> 
  summarise(n = n(), .groups = "drop")

individuals |> 
  group_by(sex) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = sex, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Sex", y = "Count")

individuals |> 
  group_by(seniority) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = seniority, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Seniority in Years", y = "Count")

individuals |> 
  group_by(academic_degree) |> 
  summarise(n = n()) |> 
  ggplot(mapping = aes(x = academic_degree, y = n)) +
  geom_col() +
      geom_text(aes(label = n), vjust = -0.5) +
      labs(x = "Academic Degree Held", y = "Count")

individuals |> 
  filter(academic_degree == "prof") |> 
  group_by(seniority) |> 
  summarise(n = n()) 

```

-   Example 2

```{r}
#| label: dvs-5-2

# Lab 3 Question 9
teacher_evals_clean |> 
  group_by(teacher_id, course_id) |> 
  summarise(number_of_instances = n()) |> 
  select(teacher_id, course_id, number_of_instances) |> 
  ungroup() |> 
  filter(number_of_instances == 9) |> 
  n_distinct()

```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1

# Challenge 4 
# revised: added _childcare to make to add context to the column names
home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")


ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center_childcare = center_care,
                          family_childcare = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`,
              names_prefix = "mean_cost_") |> 
  
  arrange(
    desc(mean_cost_center_childcare)
    )

```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2

```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3

# Lab 4 Question 4
# column made more sense to be placed before the state name

ca_childcare <- ca_childcare |> 
  mutate(county_name = str_remove_all(county_name, " County"),
         county_name = as_factor(county_name),
         study_year = as.integer(study_year),
    `California Region` = fct_collapse(.f = county_name,
                          `Superior` = superior_counties,
                          `North Coast` = north_coast_counties,
                          `San Francisco` = san_fran_counties,
                          `North San Joaquin` = n_san_joaquin_counties,
                          `Central Coast` = central_coast_counties,
                          `Sounth San Joaquin` = s_san_joaquin_counties,
                          `Inland Empire` = inland_counties,
                          `Los Angeles` = la_county,
                          `Orange` = orange_county,
                          `San Diego-Imperial` = san_diego_imperial_counties
                          ), .before = state_name)

```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1

```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2

# Challenge 4
# Pivoted after creating a long df
home_care <- c("family_based_infant",
               "family_based_toddler",
               "family_based_preschool")

center_care <- c("center_based_infant",
                 "center_based_toddler",
                 "center_based_preschool")


ca_cc_table |>
  filter( study_year == 2018) |> 
  group_by(`California Region`) |> 
    summarise(center_based_infant = median(mc_infant),
            family_based_infant = median(mfcc_infant),
            center_based_toddler = median(mc_toddler),
            family_based_toddler = median(mfcc_toddler),
            center_based_preschool = median(mc_preschool),
            family_based_preschool = median(mfcc_preschool),
            .groups = "drop"  ) |> 

  pivot_longer(cols = - `California Region`, 
               names_to = "costs") |>
  
  mutate(childcare_type = fct_collapse(.f = costs,
                          center_childcare = center_care,
                          family_childcare = home_care)) |> 

  select(- costs) |> 
  group_by(`California Region`, childcare_type) |> 
  summarise(`Mean Cost of Childcare` = mean(value), .groups = "drop") |> 
  
  pivot_wider(names_from = childcare_type, 
              values_from = `Mean Cost of Childcare`,
              names_prefix = "mean_cost_") |> 
  
  arrange(desc(mean_cost_center_childcare))

```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call

# Lab 5 
# Revised formatting for clearer code
get_fit_now_member |> 
  left_join(get_fit_now_check_in, by = join_by(id == membership_id)) |> 
  left_join(interview, by = join_by(person_id)) |> 
  mutate(check_in_date = ymd(check_in_date)) |> 
  filter(year(check_in_date) == 2018,
         month(check_in_date) == 01,
         day(check_in_date) == 09,
         str_detect(id, pattern = "^48Z"),
         membership_status == "gold") |> 
  select(id,
         name,
         membership_status,
         check_in_date,
         transcript)


```

-   using `across()`

```{r}
#| label: pe-1-across

#Lab 3 Question 5
teacher_evals_clean <- evaluations |> 
  select(course_id,
         teacher_id,
         question_no,
         no_participants,
         resp_share,
         SET_score_avg,
         percent_failed_cur,
         academic_degree,
         seniority,
         gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)
         ))
```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1

```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1

```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2

```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3

```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across

#Lab 3 Question 5
teacher_evals_clean <- evaluations |> 
  select(course_id,
         teacher_id,
         question_no,
         no_participants,
         resp_share,
         SET_score_avg,
         percent_failed_cur,
         academic_degree,
         seniority,
         gender) |> 
  rename(sex = gender) |> 
  filter(no_participants > 9) |> 
  mutate(teacher_id = as.character(teacher_id),
         across(
           .cols = c(question_no, no_participants, seniority),
           .fns = ~ as.integer(.x)
         ))

```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1

```

-   using a `map()` function with **more than one** input (e.g., `map_2()` or `pmap()`)

```{r}
#| label: pe-3-map-2

```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1

# Challenge 4 Open Ended Analysis
# The dollar function was superseded and replaced by the label_currency() function

ca_cc_table |> 
  group_by(`California Region`, study_year) |> 
  summarise(`Center Based Infant` = median(mc_infant),
            `Family Based Infant` = median(mfcc_infant),
            `Center Based Toddler` = median(mc_toddler),
            `Family Based Toddler` = median(mfcc_toddler),
            `Center Based Preschool` = median(mc_preschool),
            `Family Based Preschool` = median(mfcc_preschool),
            .groups = "drop"  ) |> 
  
    pivot_longer(cols = - c(`California Region`, study_year), 
               names_to = "costs") |> 
  
  ggplot(
    mapping = aes(x = study_year, y = value, color = costs)
    ) +
    geom_jitter(alpha = 0.8 ) + 
    facet_wrap(~ `California Region`) +
  labs(x = "Year", y = "",
      color = "Types of Childcare",
      title = "Childcare Costs by Region from 2008 - 2018",
      subtitle = "Median Cost of Childcare ($)") +
  scale_y_continuous(labels = scales::label_currency(prefix = "$")) +
  
  theme_bw() +
  theme(panel.background = element_rect(fill = "gray96"))


```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2

# Challenge 4 Open Ended Analysis
ca_cc_table |> 
  group_by(`California Region`, study_year) |> 
  summarise(`Center Based Infant` = median(mc_infant),
            `Family Based Infant` = median(mfcc_infant),
            `Center Based Toddler` = median(mc_toddler),
            `Family Based Toddler` = median(mfcc_toddler),
            `Center Based Preschool` = median(mc_preschool),
            `Family Based Preschool` = median(mfcc_preschool),
            .groups = "drop"  ) |> 
  
    pivot_longer(cols = - c(`California Region`, study_year), 
               names_to = "costs") |> 
  
  ggplot(
    mapping = aes(x = study_year, y = value, color = costs)
    ) +
    geom_jitter(alpha = 0.8 ) + 
    facet_wrap(~ `California Region`) +
  labs(x = "Year", y = "",
      color = "Types of Childcare",
      title = "Childcare Costs by Region from 2008 - 2018",
      subtitle = "Median Cost of Childcare ($)") +
  scale_y_continuous(labels = scales::label_currency(prefix = "$")) +
  
  theme_bw() +
  theme(panel.background = element_rect(fill = "gray96"))

```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1

```

-   Example 2

```{r}
#| label: dsm-1-2

```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

```{r}
#| label: dsm-2-1

#Challenge 3 Question 3
#Chi squared test
chisq.test(x = teacher_evals_compare$SET_level,
           y = teacher_evals_compare$sen_level)

```

-   Example 2

```{r}
#| label: dsm-2-2

# Lab 4 Question 9
# Linear regression model
reg_mod1 <- lm(formula = mc_infant ~ mhi_2018,
               data = ca_childcare)
summary(reg_mod1)

```

-   Example 3

```{r}
#| label: dsm-2-3

```

## Revising My Thinking

<!-- How did you revise your thinking throughout the course? How did you revise your thinking on the code examples you have provided in your portfolio? -->

Through my time as a student in this class I have been able to revise my thinking after getting feedback. In many of the labs the feedback helped me improve the clarity and efficiency of my code. One example that I remember is learning about more efficient ways of writing functions. Instead of using a lengthy collection of or statements one can make a c() and use the %in% operator to achieve the same goal. I took what I learned from this and many other feedback comments and used it to work on my future assignments. I learned from my mistakes and when I committed new ones I turned in revisions and learned from those as well.

<!-- For the revisions included in your Portfolio, to help me understand the nature of your revisions, please denote somehow the feedback I provided you (e.g., boldface, italics, colored text) before your revisions. -->

Comments were provided on each cell with revisions. I stated what i revised and why I revised it to meet the portfolio expectations.

## Extending My Thinking

<!-- How did you extended your thinking throughout the course? How did you extend your thinking on the code examples you have provided in your portfolio? -->

I extended my thinking by taking

## Peer Support & Collaboration

<!-- Include an image or a description of feedback you gave that you are proud of (either in a peer review or in Discord). -->

<!-- Include a description of how you grew as a collaborator through the weekly pair programming activities.   -->
